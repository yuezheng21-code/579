# 审视结果与修复方案（当前仓库状态）

## 1) 当前结论

在当前仓库中，仅发现 `.gitattributes`，未发现任何前端/后端源码、构建脚本、依赖清单或 Railway 部署配置。

这意味着：
- 无法直接定位“首页未显示登录界面”的代码位置。
- 无法实际落地“响应式登录窗口”和“移动端表格改卡片列表”。
- 无法审计“密码重置流程”中的严重 BUG（缺少接口与页面实现）。
- 无法复现 Railway 部署失败原因（缺少 `package.json` / `Dockerfile` / 启动命令 / 环境变量定义等）。

## 2) 你关心的问题，我建议按这个顺序修复

### A. 首页未显示登录界面

目标行为：
- 未登录访问首页时，自动跳转到 `/login` 或显示登录弹窗。
- 已登录时才进入业务首页。

检查点：
1. 前端路由守卫（React Router / Vue Router / Next middleware）是否校验 token/session。
2. token 存储与读取是否一致（cookie vs localStorage）。
3. SSR 场景下是否误用 `window/localStorage` 导致守卫失效。
4. 登录态过期时是否有兜底跳转。

### B. 设计“屏幕自适应”的登录窗口

推荐标准：
- 桌面端：居中卡片，宽度 360~420px。
- 平板端：宽度 70~80vw，最大 420px。
- 手机端：全宽布局，左右边距 16px，输入高度 >=44px。
- 错误提示要在字段下方，避免 toast 丢失可读性。

关键实现建议：
- 使用 `max-width + width: 100%` 组合。
- 使用 `clamp()` 控制间距和标题字号。
- 输入框、按钮统一触控尺寸与间距。

### C. 移动端“表格 -> 卡片列表”

推荐策略：
- `>=768px` 继续用 table。
- `<768px` 切换为 card list（每条记录一个卡片）。

每张卡片至少包含：
- 主标题（例如姓名/订单号）。
- 次要字段（状态、日期、金额等）。
- 操作区（详情/编辑/删除）固定在底部右侧或分行。

注意：
- 保留排序/筛选能力（不要因换卡片而丢失）。
- 分页在移动端可切换为“加载更多”。

### D. 密码重置流程：高风险 BUG 清单

请优先排查以下“严重项”：
1. **重置 token 未设置过期时间**或过期校验缺失。
2. **token 可重复使用**（应一次性、用后即失效）。
3. **接口返回区分“用户不存在”**，导致用户枚举风险。
4. **重置 token 明文入库**（应哈希存储）。
5. **未做请求频控**，可被暴力撞库/短信轰炸。
6. **新密码策略缺失**（长度/复杂度/历史密码限制）。
7. **重置成功后未使旧会话失效**。
8. **日志记录泄露敏感信息**（token、邮箱、手机号）。

### E. Railway 无法部署：最常见根因

按命中率排序：
1. 启动命令错误（Railway 找不到 `start` 命令）。
2. 服务端监听了 `localhost` 而不是 `0.0.0.0`。
3. 端口未读取 `PORT` 环境变量。
4. 必填环境变量缺失（数据库 URL、JWT 密钥等）。
5. Node/Python 版本不匹配。
6. 数据库白名单/网络访问限制。
7. 构建阶段成功但运行阶段崩溃（迁移脚本/种子脚本异常）。

## 3) 下一步我可以直接帮你做的（拿到代码后）

你把项目代码（至少前端登录页、表格页、密码重置接口、部署配置）推到这个仓库后，我会按以下方式一次性处理：

1. 修复首页登录态守卫（未登录强制进入登录页）。
2. 落地响应式登录窗口（桌面/平板/手机断点）。
3. 将移动端表格改为卡片列表并保持筛选/分页可用。
4. 审计并修复密码重置严重漏洞（token 生命周期、一次性、频控等）。
5. 修复 Railway 部署配置（启动命令、端口监听、环境变量）。
6. 给出可复现的本地与线上验证步骤。

## 4) 为了最快修好，请你补充这些信息

- 技术栈：React/Vue/Next/Nuxt + Node/Nest/Django/Spring？
- 当前 Railway 报错日志（Build logs + Deploy logs）。
- 你期望的登录流程（独立登录页 or 首页弹窗）。
- 密码重置是邮箱链接还是短信验证码。

