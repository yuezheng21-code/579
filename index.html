<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0f172a">
<link rel="manifest" href="/manifest.json">
<title>Ê∏äÂçö579 HR V6</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0f172a;--card:#1e293b;--card2:#334155;--border:#475569;--pri:#4f6ef7;--pri2:#6366f1;
--green:#22c55e;--red:#ef4444;--yellow:#eab308;--orange:#f97316;--cyan:#06b6d4;
--text:#e2e8f0;--text2:#94a3b8;--text3:#64748b;--radius:10px;--safe-top:env(safe-area-inset-top,0px);
--safe-bottom:env(safe-area-inset-bottom,0px)}
html,body,#root{height:100%;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:14px;overflow:hidden}
::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
.fade{animation:fadeIn .25s ease}
/* Layout */
.app{display:flex;height:100%;padding-top:var(--safe-top)}
.sidebar{width:220px;background:var(--card);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow-y:auto;flex-shrink:0;transition:transform .3s}
.sidebar .logo{padding:16px;text-align:center;font-size:18px;font-weight:700;color:var(--pri);border-bottom:1px solid var(--border)}
.sidebar .logo small{display:block;font-size:11px;color:var(--text2);font-weight:400}
.nav-item{padding:10px 16px;cursor:pointer;display:flex;align-items:center;gap:8px;color:var(--text2);transition:.15s;font-size:13px;border-left:3px solid transparent}
.nav-item:hover{background:rgba(79,110,247,.1);color:var(--text)}
.nav-item.active{background:rgba(79,110,247,.15);color:var(--pri);border-left-color:var(--pri);font-weight:600}
.nav-group{padding:8px 16px 4px;font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:4px}
.main{flex:1;display:flex;flex-direction:column;overflow:hidden}
.header{height:52px;background:var(--card);border-bottom:1px solid var(--border);display:flex;align-items:center;padding:0 16px;gap:12px;flex-shrink:0}
.header .menu-btn{display:none;font-size:20px;cursor:pointer;padding:4px}
.header .title{font-size:16px;font-weight:600;flex:1}
.header .user-info{display:flex;align-items:center;gap:8px;font-size:13px}
.header .badge{background:var(--pri);color:#fff;padding:2px 8px;border-radius:10px;font-size:11px}
.content{flex:1;overflow-y:auto;padding:16px;padding-bottom:calc(16px + var(--safe-bottom))}
/* Components */
.card{background:var(--card);border-radius:var(--radius);padding:16px;margin-bottom:12px;border:1px solid var(--border)}
.login-page{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:24px;background:radial-gradient(circle at 20% 20%,rgba(79,110,247,.18),transparent 38%),radial-gradient(circle at 80% 80%,rgba(99,102,241,.16),transparent 40%),var(--bg)}
.login-card{width:min(420px,100%);padding:24px 20px;border-radius:14px;box-shadow:0 12px 42px rgba(2,6,23,.45);text-align:center}
.login-fallback{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:24px;background:radial-gradient(circle at 20% 20%,rgba(79,110,247,.18),transparent 38%),radial-gradient(circle at 80% 80%,rgba(99,102,241,.16),transparent 40%),var(--bg);z-index:5}
.login-fallback .login-card{max-width:420px;width:100%}
.login-fallback .hint{margin-top:10px;font-size:12px;color:var(--text3)}
.stats{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-bottom:16px}
.stat{background:var(--card);border-radius:var(--radius);padding:14px;border:1px solid var(--border);text-align:center}
.stat .num{font-size:28px;font-weight:700;color:var(--pri)}
.stat .label{font-size:12px;color:var(--text2);margin-top:4px}
.btn{padding:6px 14px;border-radius:6px;border:none;cursor:pointer;font-size:13px;font-weight:500;transition:.15s;display:inline-flex;align-items:center;gap:4px}
.btn-pri{background:var(--pri);color:#fff}.btn-pri:hover{background:var(--pri2)}
.btn-green{background:var(--green);color:#fff}.btn-red{background:var(--red);color:#fff}
.btn-ghost{background:transparent;color:var(--text2);border:1px solid var(--border)}.btn-ghost:hover{color:var(--text);border-color:var(--text2)}
.btn-sm{padding:4px 10px;font-size:12px}
.table-wrap{overflow-x:auto;margin-top:8px}
table{width:100%;border-collapse:collapse;font-size:13px}
th{background:var(--card2);padding:8px 10px;text-align:left;font-weight:600;white-space:nowrap;position:sticky;top:0;z-index:1}
td{padding:7px 10px;border-top:1px solid var(--border);white-space:nowrap}
tr:hover td{background:rgba(79,110,247,.05)}
.badge-s{padding:2px 8px;border-radius:10px;font-size:11px;font-weight:600;display:inline-block}
.bg-green{background:rgba(34,197,94,.15);color:var(--green)}
.bg-red{background:rgba(239,68,68,.15);color:var(--red)}
.bg-yellow{background:rgba(234,179,8,.15);color:var(--yellow)}
.bg-blue{background:rgba(79,110,247,.15);color:var(--pri)}
.bg-cyan{background:rgba(6,182,212,.15);color:var(--cyan)}
.bg-orange{background:rgba(249,115,22,.15);color:var(--orange)}
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:100;display:flex;align-items:center;justify-content:center;padding:16px}
.modal{background:var(--card);border-radius:12px;padding:20px;max-width:600px;width:100%;max-height:85vh;overflow-y:auto;border:1px solid var(--border)}
.modal h3{margin-bottom:12px;font-size:16px}
.form-row{display:flex;gap:10px;margin-bottom:10px;flex-wrap:wrap}
.form-field{flex:1;min-width:140px}
.form-field label{display:block;font-size:12px;color:var(--text2);margin-bottom:4px}
.form-field input,.form-field select,.form-field textarea{width:100%;padding:7px 10px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);font-size:13px}
.form-field textarea{resize:vertical;min-height:60px}
.tabs{display:flex;gap:2px;margin-bottom:12px;overflow-x:auto}
.tab{padding:7px 14px;cursor:pointer;border-radius:6px;font-size:13px;color:var(--text2);white-space:nowrap;transition:.15s}
.tab.active{background:var(--pri);color:#fff}
.tag{display:inline-block;padding:2px 6px;border-radius:4px;font-size:11px;margin:1px}
.search-bar{display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap}
.search-bar input{flex:1;min-width:200px;padding:7px 12px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);font-size:13px}
.search-bar input:focus{outline:none;border-color:var(--pri)}
.toast{position:fixed;top:16px;right:16px;padding:10px 20px;border-radius:8px;color:#fff;z-index:200;animation:fadeIn .3s}
.empty{text-align:center;padding:40px;color:var(--text3)}
/* Grade chart */
.grade-bar{display:flex;align-items:center;gap:8px;margin:4px 0}
.grade-bar .bar{flex:1;height:22px;background:var(--bg);border-radius:4px;overflow:hidden;position:relative}
.grade-bar .fill{height:100%;border-radius:4px;display:flex;align-items:center;padding:0 6px;font-size:11px;color:#fff;font-weight:600;transition:width .5s}
/* Info card */
.info-card{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
.info-item{padding:12px;background:var(--bg);border-radius:8px;border:1px solid var(--border)}
.info-item .label{font-size:11px;color:var(--text3);margin-bottom:4px}
.info-item .value{font-size:14px;font-weight:600}
/* Mobile */
@media(max-width:768px){
  .sidebar{position:fixed;left:0;top:0;bottom:0;z-index:50;transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .sidebar-mask{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:49;display:none}
  .sidebar-mask.show{display:block}
  .header .menu-btn{display:block}
  .stats{grid-template-columns:repeat(2,1fr)}
  .content{padding:12px}
  .form-row{flex-direction:column}
  .form-field{min-width:100%}
  .login-page{padding:14px}
  .login-card{padding:18px 14px}
  .table-wrap{overflow:visible}
  table,thead,tbody,tr,th,td{display:block}
  thead{display:none}
  tr{border:1px solid var(--border);border-radius:10px;background:var(--card);padding:8px 10px;margin-bottom:10px}
  td{padding:6px 0;border-top:none;white-space:normal}
  td:not(:last-child){border-bottom:1px dashed rgba(148,163,184,.22)}
}
/* Print */
@media print{.sidebar,.header{display:none!important}.content{padding:0!important}}
</style>
</head>
<body>
<div id="login-fallback" class="login-fallback">
  <div class="card login-card">
    <div style="font-size:28px;font-weight:700;color:var(--pri);margin-bottom:4px">Ê∏äÂçö579</div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:20px">HR Management System V6</div>
    <div id="fallback-lang" style="display:flex;gap:6px;flex-wrap:wrap;justify-content:center;margin-bottom:12px"></div>
    <div class="form-field" style="text-align:left;margin-bottom:8px">
      <label id="fallback-label-username">Áî®Êà∑Âêç</label>
      <input id="fallback-username" type="text" placeholder="ËØ∑ËæìÂÖ•Áî®Êà∑Âêç" autocomplete="username" />
    </div>
    <div class="form-field" style="text-align:left;margin-bottom:12px">
      <label id="fallback-label-password">ÂØÜÁ†Å</label>
      <input id="fallback-password" type="password" placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å" autocomplete="current-password" />
    </div>
    <button id="fallback-login" class="btn btn-pri" style="width:100%;padding:10px;font-size:15px">ÁôªÂΩï</button>
    <div id="fallback-result" class="hint" style="display:none"></div>
    <div id="fallback-hint" class="hint">Áî®Êà∑ÂêçÂØÜÁ†ÅÈúÄË¶ÅËÅîÁ≥ªÁÆ°ÁêÜÂëòËµã‰∫à„ÄÇËã•È°µÈù¢ÈïøÊó∂Èó¥Âè™ÊòæÁ§∫Ê≠§ÁïåÈù¢ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªú/CDNÂä†ËΩΩ„ÄÇ</div>
  </div>
</div>
<div id="root"></div>
<script>
(() => {
  const fallback = document.getElementById('login-fallback');
  if(!fallback) return;
  // If the user is already logged in, hide fallback immediately so it does not block the system page
  try {
    const savedToken = localStorage.getItem('hr_token');
    const savedUser = JSON.parse(localStorage.getItem('hr_user'));
    if(savedToken && savedUser && savedUser.username) {
      fallback.style.display = 'none';
    }
  } catch(e) { /* ignore localStorage / JSON parse errors */ }
  const langs = [
    {c:'zh',n:'‰∏≠Êñá',u:'Áî®Êà∑Âêç',p:'ÂØÜÁ†Å',l:'ÁôªÂΩï',h:'Áî®Êà∑ÂêçÂØÜÁ†ÅÈúÄË¶ÅËÅîÁ≥ªÁÆ°ÁêÜÂëòËµã‰∫à„ÄÇËã•È°µÈù¢ÈïøÊó∂Èó¥Âè™ÊòæÁ§∫Ê≠§ÁïåÈù¢ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªú/CDNÂä†ËΩΩ„ÄÇ',phu:'ËØ∑ËæìÂÖ•Áî®Êà∑Âêç',php:'ËØ∑ËæìÂÖ•ÂØÜÁ†Å'},
    {c:'en',n:'English',u:'Username',p:'Password',l:'Login',h:'Contact administrator for account credentials. If only this page appears, check CDN/network loading.',phu:'Enter username',php:'Enter password'},
    {c:'de',n:'Deutsch',u:'Benutzer',p:'Passwort',l:'Anmelden',h:'Zugangsdaten bitte beim Administrator anfordern. Wenn nur diese Seite bleibt, CDN/Netzwerk pr√ºfen.',phu:'Benutzer eingeben',php:'Passwort eingeben'},
    {c:'vi',n:'Ti·∫øng Vi·ªát',u:'T√™n ƒëƒÉng nh·∫≠p',p:'M·∫≠t kh·∫©u',l:'ƒêƒÉng nh·∫≠p',h:'Vui l√≤ng li√™n h·ªá qu·∫£n tr·ªã vi√™n ƒë·ªÉ ƒë∆∞·ª£c c·∫•p t√†i kho·∫£n. N·∫øu ch·ªâ th·∫•y m√†n h√¨nh n√†y, h√£y ki·ªÉm tra CDN/m·∫°ng.',phu:'Nh·∫≠p t√™n ƒëƒÉng nh·∫≠p',php:'Nh·∫≠p m·∫≠t kh·∫©u'},
    {c:'ar',n:'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',u:'ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',p:'ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±',l:'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ',h:'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ŸàÿßÿµŸÑ ŸÖÿπ ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ ŸÑŸÖŸÜÿ≠ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿØÿÆŸàŸÑ. ÿ•ÿ∞ÿß ÿ∏Ÿáÿ±ÿ™ Ÿáÿ∞Ÿá ÿßŸÑÿ¥ÿßÿ¥ÿ© ŸÅŸÇÿ∑ÿå ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ¥ÿ®ŸÉÿ©/CDN.',phu:'ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',php:'ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±'},
    {c:'hu',n:'Magyar',u:'Felhaszn√°l√≥n√©v',p:'Jelsz√≥',l:'Bejelentkez√©s',h:'A bel√©p√©si adatok√©rt fordulj a rendszergazd√°hoz. Ha csak ez a k√©perny≈ë l√°tszik, ellen≈ërizd a h√°l√≥zatot/CDN-t.',phu:'Felhaszn√°l√≥n√©v',php:'Jelsz√≥'}
  ];
  let lang = localStorage.getItem('fallback_lang') || 'zh';
  const map = Object.fromEntries(langs.map(x=>[x.c,x]));
  const langWrap = document.getElementById('fallback-lang');
  const uLabel = document.getElementById('fallback-label-username');
  const pLabel = document.getElementById('fallback-label-password');
  const uInput = document.getElementById('fallback-username');
  const pInput = document.getElementById('fallback-password');
  const btn = document.getElementById('fallback-login');
  const hint = document.getElementById('fallback-hint');
  const result = document.getElementById('fallback-result');

  const showResult = (msg, ok=false) => {
    result.style.display = 'block';
    result.style.color = ok ? 'var(--green)' : 'var(--red)';
    result.textContent = msg;
  };
  const renderLang = () => {
    const cur = map[lang] || map.zh;
    uLabel.textContent = cur.u;
    pLabel.textContent = cur.p;
    btn.textContent = cur.l;
    hint.textContent = cur.h;
    uInput.placeholder = cur.phu;
    pInput.placeholder = cur.php;
    langWrap.innerHTML = '';
    langs.forEach(l => {
      const chip = document.createElement('span');
      chip.textContent = l.n;
      chip.style.cssText = 'cursor:pointer;padding:2px 8px;border-radius:4px;font-size:11px;';
      chip.style.background = l.c===lang ? 'var(--pri)' : 'var(--card2)';
      chip.style.color = l.c===lang ? '#fff' : 'var(--text2)';
      chip.onclick = () => {
        lang = l.c;
        localStorage.setItem('fallback_lang', lang);
        renderLang();
      };
      langWrap.appendChild(chip);
    });
  };
  const doLogin = async () => {
    const username = uInput.value.trim();
    const password = pInput.value;
    if(!username || !password) return showResult('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å');
    btn.disabled = true;
    try {
      const res = await fetch('/api/login', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({username, password})
      });
      const data = await res.json().catch(() => ({}));
      if(!res.ok || !data.token){
        throw new Error(data.detail || 'ÁôªÂΩïÂ§±Ë¥•');
      }
      localStorage.setItem('hr_token', data.token);
      localStorage.setItem('hr_user', JSON.stringify(data.user || {}));
      showResult('ÁôªÂΩïÊàêÂäüÔºåÊ≠£Âú®ËøõÂÖ•Á≥ªÁªü...', true);
      setTimeout(() => location.reload(), 300);
    } catch (e) {
      showResult(String(e.message || e));
    } finally {
      btn.disabled = false;
    }
  };
  btn.addEventListener('click', doLogin);
  pInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') doLogin(); });
  renderLang();
})();
</script>
<script type="text/babel">
const {useState,useEffect,useCallback,useMemo,useRef,createContext,useContext} = React;

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê i18n ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const T = {
  zh:{dashboard:'‰ª™Ë°®Áõò',employees:'Ëä±ÂêçÂÜå',suppliers:'‰æõÂ∫îÂïÜ',grades:'ËÅåÁ∫ß‰ΩìÁ≥ª',performance:'Áª©ÊïàËÄÉÊ†∏',
    quotation:'Êä•‰ª∑ÁÆ°ÁêÜ',files:'‰∫∫ÂëòÊ°£Ê°à',leave:'ÂÅáÊúüÁÆ°ÁêÜ',expense:'Êä•ÈîÄÂÆ°Êâπ',
    timesheet:'Â∑•Êó∂ËÆ∞ÂΩï',container:'Ë£ÖÂç∏Êüú',settlement:'Ë¥¢Âä°ÁªìÁÆó',schedule:'ÊéíÁè≠',
    dispatch:'Ê¥æÈÅ£ÈúÄÊ±Ç',clock:'ÊâìÂç°',messages:'Ê∂àÊÅØ',analytics:'Êï∞ÊçÆÂàÜÊûê',admin:'ÊùÉÈôêÁÆ°ÁêÜ',
    login:'ÁôªÂΩï',logout:'ÈÄÄÂá∫',username:'Áî®Êà∑Âêç',password:'ÂØÜÁ†Å',search:'ÊêúÁ¥¢',add:'Êñ∞Â¢û',
    edit:'ÁºñËæë',delete:'Âà†Èô§',export:'ÂØºÂá∫',approve:'ÂÆ°Êâπ',save:'‰øùÂ≠ò',cancel:'ÂèñÊ∂à',
    name:'ÂßìÂêç',grade:'ËÅåÁ∫ß',status:'Áä∂ÊÄÅ',date:'Êó•Êúü',amount:'ÈáëÈ¢ù',total:'ÂêàËÆ°',
    pending:'ÂæÖÂÆ°Êâπ',approved:'Â∑≤ÊâπÂáÜ',rejected:'Â∑≤ÊãíÁªù',all:'ÂÖ®ÈÉ®',
    mypage:'ÊàëÁöÑÈ°µÈù¢',accounts:'Ë¥¶Âè∑ÁÆ°ÁêÜ',whsalary:'‰ªìÂ∫ìËñ™ËµÑ'},
  en:{dashboard:'Dashboard',employees:'Employees',suppliers:'Suppliers',grades:'Grade System',performance:'Performance',
    quotation:'Quotation',files:'Employee Files',leave:'Leave Mgmt',expense:'Expense',
    timesheet:'Timesheet',container:'Container',settlement:'Settlement',schedule:'Schedule',
    dispatch:'Dispatch',clock:'Clock',messages:'Messages',analytics:'Analytics',admin:'Admin',
    login:'Login',logout:'Logout',username:'Username',password:'Password',search:'Search',add:'Add',
    edit:'Edit',delete:'Delete',export:'Export',approve:'Approve',save:'Save',cancel:'Cancel',
    name:'Name',grade:'Grade',status:'Status',date:'Date',amount:'Amount',total:'Total',
    pending:'Pending',approved:'Approved',rejected:'Rejected',all:'All',
    mypage:'My Page',accounts:'Accounts',whsalary:'WH Salary'},
  de:{dashboard:'Dashboard',employees:'Mitarbeiter',suppliers:'Lieferanten',grades:'Stufensystem',performance:'Leistung',
    quotation:'Angebot',files:'Personalakte',leave:'Urlaub',expense:'Spesen',
    timesheet:'Zeiterfassung',container:'Container',settlement:'Abrechnung',schedule:'Dienstplan',
    dispatch:'Disposition',clock:'Stempeluhr',messages:'Nachrichten',analytics:'Analyse',admin:'Admin',
    login:'Anmelden',logout:'Abmelden',username:'Benutzer',password:'Passwort',search:'Suche',add:'Neu',
    edit:'Bearbeiten',delete:'L√∂schen',export:'Export',approve:'Genehmigen',save:'Speichern',cancel:'Abbrechen',
    name:'Name',grade:'Stufe',status:'Status',date:'Datum',amount:'Betrag',total:'Gesamt',
    pending:'Ausstehend',approved:'Genehmigt',rejected:'Abgelehnt',all:'Alle',
    mypage:'Meine Seite',accounts:'Konten',whsalary:'Lager Gehalt'},
  vi:{dashboard:'B·∫£ng ƒëi·ªÅu khi·ªÉn',employees:'Nh√¢n vi√™n',suppliers:'Nh√† cung c·∫•p',grades:'H·ªá c·∫•p b·∫≠c',performance:'Hi·ªáu su·∫•t',
    quotation:'B√°o gi√°',files:'H·ªì s∆° nh√¢n s·ª±',leave:'Ngh·ªâ ph√©p',expense:'Chi ph√≠',
    timesheet:'Ch·∫•m c√¥ng',container:'Container',settlement:'Quy·∫øt to√°n',schedule:'L·ªãch l√†m vi·ªác',
    dispatch:'ƒêi·ªÅu ph·ªëi',clock:'Ch·∫•m gi·ªù',messages:'Tin nh·∫Øn',analytics:'Ph√¢n t√≠ch',admin:'Qu·∫£n tr·ªã',
    login:'ƒêƒÉng nh·∫≠p',logout:'ƒêƒÉng xu·∫•t',username:'T√™n ƒëƒÉng nh·∫≠p',password:'M·∫≠t kh·∫©u',search:'T√¨m ki·∫øm',add:'Th√™m',
    edit:'S·ª≠a',delete:'X√≥a',export:'Xu·∫•t',approve:'Ph√™ duy·ªát',save:'L∆∞u',cancel:'H·ªßy',
    name:'T√™n',grade:'C·∫•p b·∫≠c',status:'Tr·∫°ng th√°i',date:'Ng√†y',amount:'S·ªë ti·ªÅn',total:'T·ªïng',
    pending:'Ch·ªù duy·ªát',approved:'ƒê√£ duy·ªát',rejected:'T·ª´ ch·ªëi',all:'T·∫•t c·∫£',
    mypage:'Trang c·ªßa t√¥i',accounts:'T√†i kho·∫£n',whsalary:'L∆∞∆°ng kho'},
  ar:{dashboard:'ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ',employees:'ÿßŸÑŸÖŸàÿ∏ŸÅŸàŸÜ',suppliers:'ÿßŸÑŸÖŸàÿ±ÿØŸàŸÜ',grades:'ŸÜÿ∏ÿßŸÖ ÿßŸÑÿØÿ±ÿ¨ÿßÿ™',performance:'ÿßŸÑÿ£ÿØÿßÿ°',
    quotation:'ÿπÿ±Ÿàÿ∂ ÿßŸÑÿ£ÿ≥ÿπÿßÿ±',files:'ŸÖŸÑŸÅÿßÿ™ ÿßŸÑŸÖŸàÿ∏ŸÅŸäŸÜ',leave:'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ•ÿ¨ÿßÿ≤ÿßÿ™',expense:'ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™',
    timesheet:'ÿ≥ÿ¨ŸÑ ÿßŸÑÿ≥ÿßÿπÿßÿ™',container:'ÿßŸÑÿ≠ÿßŸàŸäÿßÿ™',settlement:'ÿßŸÑÿ™ÿ≥ŸàŸäÿ©',schedule:'ÿßŸÑÿ¨ÿØŸàŸÑ',
    dispatch:'ÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ',clock:'ÿßŸÑÿ≥ÿßÿπÿ©',messages:'ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ',analytics:'ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™',admin:'ÿßŸÑÿ•ÿØÿßÿ±ÿ©',
    login:'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ',logout:'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨',username:'ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',password:'ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±',search:'ÿ®ÿ≠ÿ´',add:'ÿ•ÿ∂ÿßŸÅÿ©',
    edit:'ÿ™ÿπÿØŸäŸÑ',delete:'ÿ≠ÿ∞ŸÅ',export:'ÿ™ÿµÿØŸäÿ±',approve:'ÿßÿπÿ™ŸÖÿßÿØ',save:'ÿ≠ŸÅÿ∏',cancel:'ÿ•ŸÑÿ∫ÿßÿ°',
    name:'ÿßŸÑÿßÿ≥ŸÖ',grade:'ÿßŸÑÿØÿ±ÿ¨ÿ©',status:'ÿßŸÑÿ≠ÿßŸÑÿ©',date:'ÿßŸÑÿ™ÿßÿ±ŸäÿÆ',amount:'ÿßŸÑŸÖÿ®ŸÑÿ∫',total:'ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä',
    pending:'ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±',approved:'ÿ™ŸÖ ÿßŸÑÿßÿπÿ™ŸÖÿßÿØ',rejected:'ŸÖÿ±ŸÅŸàÿ∂',all:'ÿßŸÑŸÉŸÑ',
    mypage:'ÿµŸÅÿ≠ÿ™Ÿä',accounts:'ÿßŸÑÿ≠ÿ≥ÿßÿ®ÿßÿ™',whsalary:'ÿ±ÿßÿ™ÿ® ÿßŸÑŸÖÿ≥ÿ™ŸàÿØÿπ'},
  hu:{dashboard:'Vez√©rl≈ëpult',employees:'Munkat√°rsak',suppliers:'Besz√°ll√≠t√≥k',grades:'Szint rendszer',performance:'Teljes√≠tm√©ny',
    quotation:'√Åraj√°nlat',files:'Szem√©lyi akt√°k',leave:'Szabads√°g',expense:'K√∂lts√©gek',
    timesheet:'Munkaid≈ë',container:'Kont√©ner',settlement:'Elsz√°mol√°s',schedule:'Beoszt√°s',
    dispatch:'Diszp√©csel√©s',clock:'√ìra',messages:'√úzenetek',analytics:'Analitika',admin:'Admin',
    login:'Bejelentkez√©s',logout:'Kijelentkez√©s',username:'Felhaszn√°l√≥n√©v',password:'Jelsz√≥',search:'Keres√©s',add:'√öj',
    edit:'Szerkeszt√©s',delete:'T√∂rl√©s',export:'Export',approve:'J√≥v√°hagy√°s',save:'Ment√©s',cancel:'M√©gse',
    name:'N√©v',grade:'Szint',status:'√Ållapot',date:'D√°tum',amount:'√ñsszeg',total:'√ñsszesen',
    pending:'F√ºgg≈ëben',approved:'J√≥v√°hagyva',rejected:'Elutas√≠tva',all:'√ñsszes',
    mypage:'Saj√°t oldal',accounts:'Fi√≥kok',whsalary:'Rakt√°rb√©r'}
};
const LANGS = [{c:'zh',n:'‰∏≠Êñá'},{c:'en',n:'English'},{c:'de',n:'Deutsch'},{c:'vi',n:'Ti·∫øng Vi·ªát'},{c:'ar',n:'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©'},{c:'hu',n:'Magyar'}];
const LOCALE_MAP = {zh:'zh-CN',en:'en-US',de:'de-DE',vi:'vi-VN',ar:'ar-SA',hu:'hu-HU'};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê API Helper ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const API = {
  token: localStorage.getItem('hr_token') || '',
  setToken(t){ this.token=t; localStorage.setItem('hr_token',t) },
  async req(method,url,body){
    const opt = {method, headers:{'Content-Type':'application/json'}};
    if(this.token) opt.headers['Authorization'] = 'Bearer '+this.token;
    if(body) opt.body = JSON.stringify(body);
    const r = await fetch(url,opt);
    if(r.status===401){if(url!=='/api/login'&&url!=='/api/pin-login'){this.setToken('');localStorage.removeItem('hr_user');window.location.reload();return null}}
    return r.json();
  },
  get(u){return this.req('GET',u)}, post(u,b){return this.req('POST',u,b)},
  put(u,b){return this.req('PUT',u,b)},
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Toast ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let toastTimer;
function showToast(msg,type='success'){
  const el=document.getElementById('toast');
  if(!el)return;
  el.textContent=msg; el.style.display='block';
  el.style.background=type==='success'?'var(--green)':'var(--red)';
  clearTimeout(toastTimer); toastTimer=setTimeout(()=>el.style.display='none',2500);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Status Badge ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const SBadge=({s})=>{
  const m={'Âú®ËÅå':'bg-green','Á¶ªËÅå':'bg-red','Â∑≤ÂÖ•Ë¥¶':'bg-green','Â∑≤ÊâπÂáÜ':'bg-green',
    'ÂæÖ‰ªìÂ∫ìÂÆ°Êâπ':'bg-yellow','ÂæÖË¥¢Âä°Á°ÆËÆ§':'bg-orange','ÂæÖÂÆ°Êâπ':'bg-yellow','Â∑≤Êèê‰∫§':'bg-blue',
    'Â∑≤ÊãíÁªù':'bg-red','ÂæÖÂÆ°Ê†∏':'bg-yellow','Â∑≤ÈÄöËøá':'bg-green','Â∑≤Êé•Âèó':'bg-green',
    'ÂæÖÂõûÂ§ç':'bg-cyan','Â∑≤ÂÆåÊàê':'bg-green','ÁîüÊïà‰∏≠':'bg-green','Â∑≤Á°ÆËÆ§':'bg-green',
    'ÊãõËÅò‰∏≠':'bg-orange','ÂæÖÂ§ÑÁêÜ':'bg-yellow','Âêà‰Ωú‰∏≠':'bg-green','Â∑≤‰ªòÊ¨æ':'bg-green',
    'Â∑≤ÁîüÊàê':'bg-green','Êú™ÁîüÊàê':'bg-yellow'};
  return React.createElement('span',{className:`badge-s ${m[s]||'bg-blue'}`},s);
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Grade Color ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const gradeColor=(g)=>{
  const c={'P0':'#94a3b8','P1':'#38bdf8','P2':'#22d3ee','P3':'#34d399','P4':'#a78bfa','P5':'#f472b6',
    'P6':'#fb923c','P7':'#fbbf24','P8':'#ef4444','P9':'#dc2626',
    'M1':'#7dd3fc','M2':'#67e8f9','M3':'#86efac','M4':'#c4b5fd','M5':'#f9a8d4'};
  return c[g]||'var(--pri)';
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Login Page (Optimized - No default credentials shown) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const LoginPage=({onLogin,lang,setLang})=>{
  const [u,setU]=useState('');const[p,setP]=useState('');const[err,setErr]=useState('');const[loading,setLoading]=useState(false);
  const t=T[lang];
  const submit=async()=>{
    if(!u||!p){setErr('ËØ∑ËæìÂÖ•Áî®Êà∑ÂêçÂíåÂØÜÁ†Å');return;}
    setLoading(true);setErr('');
    const r=await API.post('/api/login',{username:u,password:p});
    setLoading(false);
    if(!r||r.detail){setErr(r?.detail||'ÁôªÂΩïÂ§±Ë¥•');return;}
    API.setToken(r.token);
    localStorage.setItem('hr_user',JSON.stringify(r.user||{}));
    onLogin(r.user);
  };
  return React.createElement('div',{className:'login-page'},
    React.createElement('div',{className:'card fade login-card'},
      React.createElement('div',{style:{fontSize:28,fontWeight:700,color:'var(--pri)',marginBottom:4}},'Ê∏äÂçö579'),
      React.createElement('div',{style:{fontSize:13,color:'var(--text2)',marginBottom:20}},'HR Management System V6'),
      React.createElement('div',{style:{display:'flex',justifyContent:'center',gap:6,marginBottom:16}},
        LANGS.map(l=>React.createElement('span',{key:l.c,onClick:()=>setLang(l.c),
          style:{cursor:'pointer',padding:'3px 8px',borderRadius:4,fontSize:12,
            background:lang===l.c?'var(--pri)':'var(--card2)',color:lang===l.c?'#fff':'var(--text2)'}},l.n))),
      err&&React.createElement('div',{style:{color:'var(--red)',fontSize:13,marginBottom:8}},err),
      React.createElement('div',{className:'form-field',style:{textAlign:'left',marginBottom:8}},
        React.createElement('label',null,t.username),
        React.createElement('input',{value:u,onChange:e=>setU(e.target.value),placeholder:'ËØ∑ËæìÂÖ•Áî®Êà∑Âêç',autoComplete:'username',
          style:{width:'100%',padding:'10px 12px',background:'var(--bg)',border:'1px solid var(--border)',borderRadius:6,color:'var(--text)',fontSize:14}})),
      React.createElement('div',{className:'form-field',style:{textAlign:'left',marginBottom:16}},
        React.createElement('label',null,t.password),
        React.createElement('input',{type:'password',value:p,onChange:e=>setP(e.target.value),placeholder:'ËØ∑ËæìÂÖ•ÂØÜÁ†Å',autoComplete:'current-password',
          onKeyDown:e=>e.key==='Enter'&&submit(),
          style:{width:'100%',padding:'10px 12px',background:'var(--bg)',border:'1px solid var(--border)',borderRadius:6,color:'var(--text)',fontSize:14}})),
      React.createElement('button',{className:'btn btn-pri',onClick:submit,disabled:loading,style:{width:'100%',padding:10,fontSize:15}},
        loading?'ÁôªÂΩï‰∏≠...':t.login),
      React.createElement('div',{style:{marginTop:16,fontSize:11,color:'var(--text3)'}},'Áî®Êà∑ÂêçÂØÜÁ†ÅÈúÄË¶ÅËÅîÁ≥ªÁÆ°ÁêÜÂëòËµã‰∫à')
    ));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Dashboard ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DashPage=({t})=>{
  const[d,setD]=useState(null);
  useEffect(()=>{API.get('/api/analytics/dashboard').then(setD)},[]);
  if(!d)return React.createElement('div',{className:'empty'},'Âä†ËΩΩ‰∏≠...');
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'stats'},
      [{n:d.total_emp,l:'Âú®ËÅåÂëòÂ∑•',c:'var(--pri)'},{n:d.own,l:'Ëá™ÊúâÂëòÂ∑•',c:'var(--green)'},
       {n:d.supplier,l:'‰æõÂ∫îÂïÜÂëòÂ∑•',c:'var(--orange)'},{n:d.wh_count,l:'‰ªìÂ∫ìÊï∞',c:'var(--cyan)'},
       {n:d.pending_ts,l:'ÂæÖÂÆ°Â∑•Êó∂',c:'var(--yellow)'},{n:d.pending_leave,l:'ÂæÖÂÆ°ÂÅáÊù°',c:'var(--red)'},
       {n:d.pending_expense,l:'ÂæÖÂÆ°Êä•ÈîÄ',c:'var(--orange)'},{n:Math.round(d.monthly_hrs),l:'Êú¨ÊúàÊÄªÂ∑•Êó∂',c:'var(--pri2)'}
      ].map((s,i)=>React.createElement('div',{key:i,className:'stat'},
        React.createElement('div',{className:'num',style:{color:s.c}},s.n),
        React.createElement('div',{className:'label'},s.l)))),
    React.createElement('div',{style:{display:'grid',gridTemplateColumns:'1fr 1fr',gap:12}},
      React.createElement('div',{className:'card'},
        React.createElement('h4',{style:{marginBottom:10}},'ËÅåÁ∫ßÂàÜÂ∏É'),
        d.grade_dist.map(g=>React.createElement('div',{key:g.grade,className:'grade-bar'},
          React.createElement('span',{style:{width:28,fontWeight:600,color:gradeColor(g.grade)}},g.grade),
          React.createElement('div',{className:'bar'},
            React.createElement('div',{className:'fill',style:{width:`${Math.min(g.c/d.total_emp*100,100)*3}%`,background:gradeColor(g.grade)}},g.c))))),
      React.createElement('div',{className:'card'},
        React.createElement('h4',{style:{marginBottom:10}},'‰ªìÂ∫ì‰∫∫Âëò'),
        d.wh_dist.map(w=>React.createElement('div',{key:w.w,className:'grade-bar'},
          React.createElement('span',{style:{width:40,fontWeight:600}},w.w||'-'),
          React.createElement('div',{className:'bar'},
            React.createElement('div',{className:'fill',style:{width:`${Math.min(w.c/d.total_emp*100,100)*3}%`,background:'var(--pri)'}},w.c)))))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê My Page (Employee Personal Page) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const MyPage=({t,user})=>{
  const[data,setData]=useState(null);const[salaryConfig,setSalaryConfig]=useState([]);
  const[tab,setTab]=useState('info');
  useEffect(()=>{
    API.get('/api/mypage').then(setData);
    API.get('/api/mypage/salary-config').then(r=>setSalaryConfig(r?.configs||[]));
  },[]);
  if(!data)return React.createElement('div',{className:'empty'},'Âä†ËΩΩ‰∏≠...');
  const emp=data.employee;
  const leaveMap={annual:'Âπ¥ÂÅá',sick:'ÁóÖÂÅá',personal:'‰∫ãÂÅá'};
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'card',style:{textAlign:'center',paddingBottom:20}},
      React.createElement('div',{style:{width:80,height:80,borderRadius:'50%',background:'var(--pri)',margin:'0 auto 12px',
        display:'flex',alignItems:'center',justifyContent:'center',fontSize:32,color:'#fff'}},emp.name?.charAt(0)),
      React.createElement('div',{style:{fontSize:20,fontWeight:700}},emp.name),
      React.createElement('div',{style:{color:'var(--text2)',marginTop:4}},emp.id,' ¬∑ ',
        React.createElement('span',{style:{color:gradeColor(emp.grade),fontWeight:600}},emp.grade)),
      React.createElement('div',{style:{marginTop:8}},
        React.createElement(SBadge,{s:emp.status}),' ',
        React.createElement('span',{className:'badge-s bg-blue'},emp.primary_wh))),
    React.createElement('div',{className:'tabs'},
      [['info','Âü∫Êú¨‰ø°ÊÅØ'],['salary','Ëñ™ËµÑÈÖçÁΩÆ'],['timesheet','Â∑•Êó∂ËÆ∞ÂΩï'],['leave','ÂÅáÊúü‰ΩôÈ¢ù']].map(([k,l])=>
        React.createElement('div',{key:k,className:`tab ${tab===k?'active':''}`,onClick:()=>setTab(k)},l))),
    tab==='info'&&React.createElement('div',{className:'card'},
      React.createElement('div',{className:'info-card'},
        [{l:'Â∑•Âè∑',v:emp.id},{l:'ÂßìÂêç',v:emp.name},{l:'ËÅåÁ∫ß',v:emp.grade},{l:'Â≤ó‰Ωç',v:emp.position},
         {l:'‰∏ª‰ªìÂ∫ì',v:emp.primary_wh},{l:'Ê¥æÈÅ£‰ªìÂ∫ì',v:emp.dispatch_whs||'-'},{l:'Êù•Ê∫ê',v:emp.source},
         {l:'ÂÖ•ËÅåÊó•Êúü',v:emp.join_date},{l:'ÁîµËØù',v:emp.phone||'-'},{l:'ÈÇÆÁÆ±',v:emp.email||'-'},
         {l:'ÂõΩÁ±ç',v:emp.nationality},{l:'ËØ≠Ë®Ä',v:emp.languages||'-'}
        ].map((it,i)=>React.createElement('div',{key:i,className:'info-item'},
          React.createElement('div',{className:'label'},it.l),
          React.createElement('div',{className:'value'},it.v))))),
    tab==='salary'&&React.createElement('div',null,
      React.createElement('div',{className:'stats',style:{marginBottom:12}},
        [{n:`‚Ç¨${data.monthly_stats?.pay?.toFixed(2)||0}`,l:'Êú¨ÊúàÂ∫îÂèë',c:'var(--green)'},
         {n:`‚Ç¨${data.monthly_stats?.net?.toFixed(2)||0}`,l:'Êú¨ÊúàÂÆûÂèë',c:'var(--pri)'},
         {n:`${data.monthly_stats?.hours?.toFixed(1)||0}h`,l:'Êú¨ÊúàÂ∑•Êó∂',c:'var(--cyan)'}
        ].map((s,i)=>React.createElement('div',{key:i,className:'stat'},
          React.createElement('div',{className:'num',style:{color:s.c}},s.n),
          React.createElement('div',{className:'label'},s.l)))),
      React.createElement('div',{className:'card'},
        React.createElement('h4',{style:{marginBottom:12}},'ÂêÑ‰ªìÂ∫ìËñ™ËµÑÈÖçÁΩÆ'),
        salaryConfig.length===0?React.createElement('div',{className:'empty'},'ÊöÇÊó†ÈÖçÁΩÆ'):
        React.createElement('div',{className:'table-wrap'},
          React.createElement('table',null,
            React.createElement('thead',null,React.createElement('tr',null,
              ['‰ªìÂ∫ì','Â≤ó‰Ωç','Êó∂Ëñ™','20GP','40GP','45HC','Â§úÁè≠%','Âë®Êú´%','Áª©ÊïàÂü∫Êï∞'].map(h=>React.createElement('th',{key:h},h)))),
            React.createElement('tbody',null,salaryConfig.map((c,i)=>React.createElement('tr',{key:i},
              React.createElement('td',null,c.warehouse_name||c.warehouse_code),
              React.createElement('td',null,c.position_type),
              React.createElement('td',{style:{color:'var(--green)',fontWeight:700}},`‚Ç¨${c.hourly_rate}`),
              React.createElement('td',null,c.container_rate_20gp?`‚Ç¨${c.container_rate_20gp}`:'-'),
              React.createElement('td',null,c.container_rate_40gp?`‚Ç¨${c.container_rate_40gp}`:'-'),
              React.createElement('td',null,c.container_rate_45hc?`‚Ç¨${c.container_rate_45hc}`:'-'),
              React.createElement('td',null,`+${c.night_bonus_pct}%`),
              React.createElement('td',null,`+${c.weekend_bonus_pct}%`),
              React.createElement('td',null,`‚Ç¨${c.perf_base}`)))))))),
    tab==='timesheet'&&React.createElement('div',{className:'card'},
      React.createElement('h4',{style:{marginBottom:12}},'ÊúÄËøëÂ∑•Êó∂ËÆ∞ÂΩï'),
      React.createElement('div',{className:'table-wrap'},
        React.createElement('table',null,
          React.createElement('thead',null,React.createElement('tr',null,
            ['Êó•Êúü','‰ªìÂ∫ì','Êó∂ÊÆµ','Â∑•Êó∂','Â∫îÂèë','ÂÆûÂèë','Áä∂ÊÄÅ'].map(h=>React.createElement('th',{key:h},h)))),
          React.createElement('tbody',null,data.recent_timesheet.map((r,i)=>React.createElement('tr',{key:i},
            React.createElement('td',null,r.work_date),React.createElement('td',null,r.warehouse_code),
            React.createElement('td',null,`${r.start_time}-${r.end_time}`),
            React.createElement('td',{style:{fontWeight:600}},r.hours+'h'),
            React.createElement('td',{style:{color:'var(--green)'}},`‚Ç¨${r.hourly_pay}`),
            React.createElement('td',{style:{fontWeight:600}},`‚Ç¨${r.net_pay}`),
            React.createElement('td',null,React.createElement(SBadge,{s:r.wh_status})))))))),
    tab==='leave'&&React.createElement('div',{className:'card'},
      React.createElement('h4',{style:{marginBottom:12}},'2026Âπ¥ÂÅáÊúü‰ΩôÈ¢ù'),
      React.createElement('div',{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(180px,1fr))',gap:12}},
        data.leave_balances.map((lb,i)=>React.createElement('div',{key:i,style:{background:'var(--bg)',padding:16,borderRadius:8,textAlign:'center'}},
          React.createElement('div',{style:{fontSize:13,color:'var(--text2)',marginBottom:8}},leaveMap[lb.leave_type]||lb.leave_type),
          React.createElement('div',{style:{fontSize:24,fontWeight:700,color:'var(--green)'}},lb.remaining_days),
          React.createElement('div',{style:{fontSize:11,color:'var(--text3)'}},`Â∑≤Áî® ${lb.used_days} / ÂÖ± ${lb.total_days} Â§©`))))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Account Management ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const AccountPage=({t})=>{
  const[accounts,setAccounts]=useState([]);const[selIds,setSelIds]=useState([]);const[showModal,setShowModal]=useState(null);
  const load=()=>API.get('/api/accounts').then(setAccounts);
  useEffect(()=>{load()},[]);
  const generateSingle=async(eid)=>{
    const r=await API.post('/api/accounts/generate',{employee_id:eid,role:'worker'});
    if(r?.ok){
      showToast(`Ë¥¶Âè∑Â∑≤ÁîüÊàê: ${r.username} / ${r.password}`);
      setShowModal({type:'result',data:[{...r}]});
      load();
    }else showToast('ÁîüÊàêÂ§±Ë¥•','error');
  };
  const generateBatch=async()=>{
    const ids=accounts.filter(a=>!a.has_account&&selIds.includes(a.id)).map(a=>a.id);
    if(!ids.length){showToast('ËØ∑ÈÄâÊã©Êú™ÁîüÊàêË¥¶Âè∑ÁöÑÂëòÂ∑•','error');return;}
    const r=await API.post('/api/accounts/batch-generate',{employee_ids:ids,role:'worker'});
    if(r?.ok){
      showToast(`Â∑≤ÁîüÊàê ${r.accounts.length} ‰∏™Ë¥¶Âè∑`);
      setShowModal({type:'result',data:r.accounts});
      setSelIds([]);load();
    }else showToast('ÊâπÈáèÁîüÊàêÂ§±Ë¥•','error');
  };
  const resetPwd=async(username)=>{
    const r=await API.post('/api/accounts/reset-password',{username});
    if(r?.ok){
      showToast(`Êñ∞ÂØÜÁ†Å: ${r.password}`);
      setShowModal({type:'result',data:[{username,password:r.password,name:''}]});
    }else showToast('ÈáçÁΩÆÂ§±Ë¥•','error');
  };
  const toggleAll=(e)=>{
    if(e.target.checked)setSelIds(accounts.map(a=>a.id));
    else setSelIds([]);
  };
  const toggleOne=(id)=>{
    if(selIds.includes(id))setSelIds(selIds.filter(i=>i!==id));
    else setSelIds([...selIds,id]);
  };
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{style:{display:'flex',gap:8,marginBottom:12}},
      React.createElement('button',{className:'btn btn-pri',onClick:generateBatch},'ÊâπÈáèÁîüÊàêË¥¶Âè∑'),
      React.createElement('span',{style:{color:'var(--text2)',fontSize:13,lineHeight:'32px'}},`Â∑≤ÈÄâ ${selIds.length} ‰∫∫`)),
    React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          React.createElement('th',null,React.createElement('input',{type:'checkbox',onChange:toggleAll,checked:selIds.length===accounts.length&&accounts.length>0})),
          ['Â∑•Âè∑','ÂßìÂêç','ËÅåÁ∫ß','‰ªìÂ∫ì','Áä∂ÊÄÅ','Ë¥¶Âè∑','Êìç‰Ωú'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,accounts.map(a=>React.createElement('tr',{key:a.id},
          React.createElement('td',null,React.createElement('input',{type:'checkbox',checked:selIds.includes(a.id),onChange:()=>toggleOne(a.id)})),
          React.createElement('td',null,a.id),React.createElement('td',null,a.name),
          React.createElement('td',{style:{color:gradeColor(a.grade),fontWeight:600}},a.grade),
          React.createElement('td',null,a.primary_wh),
          React.createElement('td',null,React.createElement(SBadge,{s:a.status})),
          React.createElement('td',null,a.has_account?
            React.createElement('span',{style:{color:'var(--green)'}},a.username):
            React.createElement('span',{style:{color:'var(--text3)'}},'Êú™ÁîüÊàê')),
          React.createElement('td',null,
            !a.has_account?React.createElement('button',{className:'btn btn-sm btn-pri',onClick:()=>generateSingle(a.id)},'ÁîüÊàê'):
            React.createElement('button',{className:'btn btn-sm btn-ghost',onClick:()=>resetPwd(a.username)},'ÈáçÁΩÆÂØÜÁ†Å'))))))),
    showModal&&React.createElement('div',{className:'modal-overlay',onClick:()=>setShowModal(null)},
      React.createElement('div',{className:'modal',onClick:e=>e.stopPropagation()},
        React.createElement('h3',null,'Ë¥¶Âè∑‰ø°ÊÅØ'),
        React.createElement('div',{style:{background:'var(--bg)',padding:12,borderRadius:8,marginBottom:12}},
          showModal.data.map((acc,i)=>React.createElement('div',{key:i,style:{marginBottom:8,padding:8,background:'var(--card2)',borderRadius:6}},
            React.createElement('div',null,React.createElement('b',null,acc.name||acc.username)),
            React.createElement('div',{style:{fontSize:13,color:'var(--text2)'}},'Áî®Êà∑Âêç: ',React.createElement('span',{style:{color:'var(--pri)'}},acc.username)),
            React.createElement('div',{style:{fontSize:13,color:'var(--text2)'}},'ÂØÜÁ†Å: ',React.createElement('span',{style:{color:'var(--green)'}},acc.password))))),
        React.createElement('div',{style:{color:'var(--yellow)',fontSize:12,marginBottom:12}},'‚ö†Ô∏è ËØ∑Â¶•ÂñÑ‰øùÂ≠òÂØÜÁ†ÅÔºåÂÖ≥Èó≠ÂêéÊó†Ê≥ïÂÜçÊ¨°Êü•Áúã'),
        React.createElement('button',{className:'btn btn-pri',onClick:()=>setShowModal(null)},'Á°ÆÂÆö'))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Warehouse Salary Config ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const WHSalaryPage=({t})=>{
  const[configs,setConfigs]=useState([]);const[whs,setWhs]=useState([]);const[selWh,setSelWh]=useState('');
  const[showEdit,setShowEdit]=useState(null);
  useEffect(()=>{
    API.get('/api/warehouses').then(setWhs);
    API.get('/api/warehouse-salary-config').then(setConfigs);
  },[]);
  const filtered=selWh?configs.filter(c=>c.warehouse_code===selWh):configs;
  const save=async()=>{
    if(showEdit.id){
      await API.put(`/api/warehouse-salary-config/${showEdit.id}`,showEdit);
    }else{
      await API.post('/api/warehouse-salary-config',showEdit);
    }
    showToast('‰øùÂ≠òÊàêÂäü');setShowEdit(null);
    API.get('/api/warehouse-salary-config').then(setConfigs);
  };
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'search-bar'},
      React.createElement('select',{value:selWh,onChange:e=>setSelWh(e.target.value),
        style:{padding:'7px 12px',background:'var(--bg)',border:'1px solid var(--border)',borderRadius:6,color:'var(--text)'}},
        React.createElement('option',{value:''},'ÂÖ®ÈÉ®‰ªìÂ∫ì'),
        whs.map(w=>React.createElement('option',{key:w.code,value:w.code},`${w.code} - ${w.name}`))),
      React.createElement('button',{className:'btn btn-pri',onClick:()=>setShowEdit({warehouse_code:'',grade:'',position_type:'Â∫ìÂÜÖ',hourly_rate:0,
        container_rate_20gp:0,container_rate_40gp:0,container_rate_45hc:0,night_bonus_pct:25,weekend_bonus_pct:50,holiday_bonus_pct:100,
        perf_base:0,perf_excellent_bonus:0,perf_good_bonus:0,settle_method:'ÊåâÂ∞èÊó∂'})},'Êñ∞Â¢ûÈÖçÁΩÆ')),
    React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['‰ªìÂ∫ì','ËÅåÁ∫ß','Â≤ó‰Ωç','Êó∂Ëñ™','20GP','40GP','45HC','Â§úÁè≠%','Âë®Êú´%','ËäÇÂÅá%','Áª©ÊïàÂü∫Êï∞','Êìç‰Ωú'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,filtered.map(c=>React.createElement('tr',{key:c.id},
          React.createElement('td',null,c.warehouse_code),
          React.createElement('td',{style:{color:gradeColor(c.grade),fontWeight:600}},c.grade),
          React.createElement('td',null,c.position_type),
          React.createElement('td',{style:{color:'var(--green)',fontWeight:700}},`‚Ç¨${c.hourly_rate}`),
          React.createElement('td',null,c.container_rate_20gp?`‚Ç¨${c.container_rate_20gp}`:'-'),
          React.createElement('td',null,c.container_rate_40gp?`‚Ç¨${c.container_rate_40gp}`:'-'),
          React.createElement('td',null,c.container_rate_45hc?`‚Ç¨${c.container_rate_45hc}`:'-'),
          React.createElement('td',null,`+${c.night_bonus_pct}%`),
          React.createElement('td',null,`+${c.weekend_bonus_pct}%`),
          React.createElement('td',null,`+${c.holiday_bonus_pct}%`),
          React.createElement('td',null,`‚Ç¨${c.perf_base}`),
          React.createElement('td',null,React.createElement('button',{className:'btn btn-sm btn-ghost',onClick:()=>setShowEdit(c)},'ÁºñËæë'))))))),
    showEdit&&React.createElement('div',{className:'modal-overlay',onClick:()=>setShowEdit(null)},
      React.createElement('div',{className:'modal',onClick:e=>e.stopPropagation()},
        React.createElement('h3',null,showEdit.id?'ÁºñËæëËñ™ËµÑÈÖçÁΩÆ':'Êñ∞Â¢ûËñ™ËµÑÈÖçÁΩÆ'),
        React.createElement('div',{className:'form-row'},
          React.createElement('div',{className:'form-field'},
            React.createElement('label',null,'‰ªìÂ∫ì'),
            React.createElement('select',{value:showEdit.warehouse_code,onChange:e=>setShowEdit({...showEdit,warehouse_code:e.target.value}),disabled:!!showEdit.id},
              React.createElement('option',{value:''},'ÈÄâÊã©‰ªìÂ∫ì'),
              whs.map(w=>React.createElement('option',{key:w.code,value:w.code},w.code)))),
          React.createElement('div',{className:'form-field'},
            React.createElement('label',null,'ËÅåÁ∫ß'),
            React.createElement('select',{value:showEdit.grade,onChange:e=>setShowEdit({...showEdit,grade:e.target.value}),disabled:!!showEdit.id},
              React.createElement('option',{value:''},'ÈÄâÊã©ËÅåÁ∫ß'),
              ['P0','P1','P2','P3','P4','P5','P6','P7','M1','M2','M3'].map(g=>React.createElement('option',{key:g,value:g},g)))),
          React.createElement('div',{className:'form-field'},
            React.createElement('label',null,'Â≤ó‰ΩçÁ±ªÂûã'),
            React.createElement('select',{value:showEdit.position_type,onChange:e=>setShowEdit({...showEdit,position_type:e.target.value}),disabled:!!showEdit.id},
              ['Â∫ìÂÜÖ','Ë£ÖÂç∏','ÁÆ°ÁêÜ'].map(p=>React.createElement('option',{key:p,value:p},p))))),
        React.createElement('div',{className:'form-row'},
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'Êó∂Ëñ™(‚Ç¨)'),
            React.createElement('input',{type:'number',step:'0.5',value:showEdit.hourly_rate,onChange:e=>setShowEdit({...showEdit,hourly_rate:parseFloat(e.target.value)||0})})),
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'ÁªìÁÆóÊñπÂºè'),
            React.createElement('select',{value:showEdit.settle_method,onChange:e=>setShowEdit({...showEdit,settle_method:e.target.value})},
              ['ÊåâÂ∞èÊó∂','ÊåâÊüú','Êåâ‰ª∂'].map(m=>React.createElement('option',{key:m,value:m},m))))),
        React.createElement('div',{className:'form-row'},
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'20GPÊüú(‚Ç¨)'),
            React.createElement('input',{type:'number',value:showEdit.container_rate_20gp,onChange:e=>setShowEdit({...showEdit,container_rate_20gp:parseFloat(e.target.value)||0})})),
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'40GPÊüú(‚Ç¨)'),
            React.createElement('input',{type:'number',value:showEdit.container_rate_40gp,onChange:e=>setShowEdit({...showEdit,container_rate_40gp:parseFloat(e.target.value)||0})})),
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'45HCÊüú(‚Ç¨)'),
            React.createElement('input',{type:'number',value:showEdit.container_rate_45hc,onChange:e=>setShowEdit({...showEdit,container_rate_45hc:parseFloat(e.target.value)||0})}))),
        React.createElement('div',{className:'form-row'},
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'Â§úÁè≠Âä†Êàê%'),
            React.createElement('input',{type:'number',value:showEdit.night_bonus_pct,onChange:e=>setShowEdit({...showEdit,night_bonus_pct:parseFloat(e.target.value)||0})})),
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'Âë®Êú´Âä†Êàê%'),
            React.createElement('input',{type:'number',value:showEdit.weekend_bonus_pct,onChange:e=>setShowEdit({...showEdit,weekend_bonus_pct:parseFloat(e.target.value)||0})})),
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'ËäÇÂÅáÊó•Âä†Êàê%'),
            React.createElement('input',{type:'number',value:showEdit.holiday_bonus_pct,onChange:e=>setShowEdit({...showEdit,holiday_bonus_pct:parseFloat(e.target.value)||0})}))),
        React.createElement('div',{className:'form-row'},
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'Áª©ÊïàÂü∫Êï∞(‚Ç¨)'),
            React.createElement('input',{type:'number',value:showEdit.perf_base,onChange:e=>setShowEdit({...showEdit,perf_base:parseFloat(e.target.value)||0})})),
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'‰ºòÁßÄÂ•ñÈáë(‚Ç¨)'),
            React.createElement('input',{type:'number',value:showEdit.perf_excellent_bonus,onChange:e=>setShowEdit({...showEdit,perf_excellent_bonus:parseFloat(e.target.value)||0})})),
          React.createElement('div',{className:'form-field'},React.createElement('label',null,'ËâØÂ•ΩÂ•ñÈáë(‚Ç¨)'),
            React.createElement('input',{type:'number',value:showEdit.perf_good_bonus,onChange:e=>setShowEdit({...showEdit,perf_good_bonus:parseFloat(e.target.value)||0})}))),
        React.createElement('div',{style:{display:'flex',gap:8,marginTop:16}},
          React.createElement('button',{className:'btn btn-pri',onClick:save},'‰øùÂ≠ò'),
          React.createElement('button',{className:'btn btn-ghost',onClick:()=>setShowEdit(null)},'ÂèñÊ∂à')))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Employees ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const EmpPage=({t})=>{
  const[emps,setEmps]=useState([]);const[q,setQ]=useState('');
  useEffect(()=>{API.get('/api/employees').then(setEmps)},[]);
  const filtered=emps.filter(e=>`${e.name}${e.id}${e.grade}${e.primary_wh}`.includes(q));
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'search-bar'},
      React.createElement('input',{value:q,onChange:e=>setQ(e.target.value),placeholder:'üîç ÊêúÁ¥¢ÂßìÂêç/Â∑•Âè∑/ËÅåÁ∫ß...'})),
    React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['Â∑•Âè∑','ÂßìÂêç','ËÅåÁ∫ß','Â≤ó‰Ωç','‰ªìÂ∫ì','Êù•Ê∫ê','Áä∂ÊÄÅ','Ë¥¶Âè∑'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,filtered.map(e=>React.createElement('tr',{key:e.id},
          React.createElement('td',null,e.id),
          React.createElement('td',null,React.createElement('b',null,e.name)),
          React.createElement('td',{style:{color:gradeColor(e.grade),fontWeight:700}},e.grade),
          React.createElement('td',null,e.position),
          React.createElement('td',null,e.primary_wh),
          React.createElement('td',null,React.createElement(SBadge,{s:e.source==='Ëá™Êúâ'?'Ëá™Êúâ':'‰æõÂ∫îÂïÜ'})),
          React.createElement('td',null,React.createElement(SBadge,{s:e.status})),
          React.createElement('td',null,React.createElement(SBadge,{s:e.has_account?'Â∑≤ÁîüÊàê':'Êú™ÁîüÊàê'}))))))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Grades ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const GradePage=({t})=>{
  const[grades,setGrades]=useState([]);const[sel,setSel]=useState(null);const[tab,setTab]=useState('ËøêËê•');
  useEffect(()=>{API.get('/api/grades').then(setGrades)},[]);
  const filtered=grades.filter(g=>g.series===tab);
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'tabs'},
      ['ËøêËê•','Ë°åÊîø'].map(s=>React.createElement('div',{key:s,className:`tab ${tab===s?'active':''}`,onClick:()=>setTab(s)},
        s==='ËøêËê•'?'ËøêËê•Â∫èÂàó P0-P9':'Ë°åÊîøÂ∫èÂàó M1-M5'))),
    React.createElement('div',{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(280px,1fr))',gap:12}},
      filtered.map(g=>{
        let criteria=[];try{criteria=JSON.parse(g.eval_criteria||'[]')}catch{}
        let perf=[];try{perf=JSON.parse(g.perf_dimensions||'[]')}catch{}
        return React.createElement('div',{key:g.code,className:'card',style:{cursor:'pointer',borderColor:sel===g.code?'var(--pri)':'var(--border)'},
          onClick:()=>setSel(sel===g.code?null:g.code)},
          React.createElement('div',{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:8}},
            React.createElement('div',null,
              React.createElement('span',{style:{fontSize:22,fontWeight:700,color:gradeColor(g.code),marginRight:8}},g.code),
              React.createElement('span',{style:{fontSize:15,fontWeight:600}},g.title_zh)),
            React.createElement('div',{style:{textAlign:'right',fontSize:12}},
              React.createElement('div',{style:{color:'var(--green)',fontWeight:700,fontSize:16}},`‚Ç¨${g.base_salary}/h`),
              React.createElement('div',{style:{color:'var(--text3)'}},g.title_de))),
          React.createElement('div',{style:{fontSize:12,color:'var(--text2)',marginBottom:6}},
            `ÁÆ°ÁêÜÂπÖÂ∫¶: ${g.manage_scope} | Ë∞É‰ª∑: ${g.adjust_pct_min}%~${g.adjust_pct_max}%`),
          React.createElement('div',{style:{fontSize:12,color:'var(--cyan)'}},`ÊôãÂçáÈÄöÈÅì: ‚Üí ${g.promotion_path||'ÊúÄÈ´òÁ∫ß'}`),
          sel===g.code&&React.createElement('div',{style:{marginTop:10,borderTop:'1px solid var(--border)',paddingTop:10}},
            React.createElement('div',{style:{fontWeight:600,marginBottom:6,fontSize:13}},'üìã ËØÑÂÆöÊ†áÂáÜ:'),
            criteria.map((c,i)=>React.createElement('div',{key:i,style:{fontSize:12,color:'var(--text2)',padding:'2px 0'}},'‚úÖ '+c)),
            perf.length>0&&React.createElement('div',{style:{marginTop:8}},
              React.createElement('div',{style:{fontWeight:600,marginBottom:4,fontSize:13}},'üìä Áª©ÊïàÁª¥Â∫¶:'),
              perf.map((p,i)=>React.createElement('div',{key:i,className:'grade-bar'},
                React.createElement('span',{style:{width:60,fontSize:12}},p.dim),
                React.createElement('div',{className:'bar'},
                  React.createElement('div',{className:'fill',style:{width:`${p.w||p.weight||0}%`,background:'var(--pri)'}},`${p.w||p.weight||0}%`)))))));})));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Timesheet ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const TSPage=({t})=>{
  const[ts,setTs]=useState([]);
  useEffect(()=>{API.get('/api/timesheet').then(setTs)},[]);
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{style:{marginBottom:8,color:'var(--text2)',fontSize:13}},`ÂÖ± ${ts.length} Êù°ËÆ∞ÂΩï`),
    React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['Êó•Êúü','ÂëòÂ∑•','ËÅåÁ∫ß','‰ªìÂ∫ì','Â≤ó‰Ωç','Êó∂ÊÆµ','Â∑•Êó∂','Êó∂Ëñ™','Â∫î‰ªò','Áä∂ÊÄÅ'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,ts.slice(0,100).map(r=>React.createElement('tr',{key:r.id},
          React.createElement('td',null,r.work_date),React.createElement('td',null,r.employee_name),
          React.createElement('td',{style:{color:gradeColor(r.grade),fontWeight:700}},r.grade),
          React.createElement('td',null,r.warehouse_code),
          React.createElement('td',null,r.position),
          React.createElement('td',null,`${r.start_time}-${r.end_time}`),
          React.createElement('td',{style:{fontWeight:700}},r.hours+'h'),
          React.createElement('td',null,`‚Ç¨${r.base_rate}`),
          React.createElement('td',{style:{color:'var(--green)',fontWeight:700}},`‚Ç¨${r.hourly_pay}`),
          React.createElement('td',null,React.createElement(SBadge,{s:r.wh_status}))))))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Settlement ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const SettPage=({t})=>{
  const[own,setOwn]=useState([]);const[sup,setSup]=useState([]);const[tab,setTab]=useState('own');
  useEffect(()=>{API.get('/api/settlement?mode=own').then(setOwn);API.get('/api/settlement?mode=supplier').then(setSup);},[]);
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'tabs'},
      [['own','Ëá™ÊúâÂëòÂ∑•'],['sup','‰æõÂ∫îÂïÜÁªìÁÆó']].map(([k,l])=>React.createElement('div',{key:k,className:`tab ${tab===k?'active':''}`,onClick:()=>setTab(k)},l))),
    tab==='own'?React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['Â∑•Âè∑','ÂßìÂêç','ËÅåÁ∫ß','‰ªìÂ∫ì','Â∑•Êó∂','Â∫î‰ªò','Á§æ‰øù','Á®é','ÂÆûÂèë'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,own.map(r=>React.createElement('tr',{key:r.employee_id},
          React.createElement('td',null,r.employee_id),React.createElement('td',null,r.employee_name),
          React.createElement('td',{style:{color:gradeColor(r.grade),fontWeight:700}},r.grade),
          React.createElement('td',null,r.warehouse_code),
          React.createElement('td',null,r.h+'h'),React.createElement('td',null,`‚Ç¨${r.pay?.toFixed(2)}`),
          React.createElement('td',null,`-‚Ç¨${r.ssi?.toFixed(2)}`),React.createElement('td',null,`-‚Ç¨${r.tax?.toFixed(2)}`),
          React.createElement('td',{style:{fontWeight:700,color:'var(--green)'}},`‚Ç¨${r.net?.toFixed(2)}`))))))
    :React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['‰æõÂ∫îÂïÜ','‰ªìÂ∫ì','‰∫∫Êï∞','ÊÄªÂ∑•Êó∂','ÊÄªË¥πÁî®'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,sup.map((r,i)=>React.createElement('tr',{key:i},
          React.createElement('td',null,r.supplier_id),React.createElement('td',null,r.warehouse_code),
          React.createElement('td',null,r.hc),React.createElement('td',null,r.h+'h'),
          React.createElement('td',{style:{fontWeight:700}},`‚Ç¨${r.pay?.toFixed(2)}`)))))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Leave ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const LeavePage=({t})=>{
  const[reqs,setReqs]=useState([]);const[types,setTypes]=useState([]);const[tab,setTab]=useState('req');
  useEffect(()=>{API.get('/api/leave-requests').then(setReqs);API.get('/api/leave-types').then(setTypes);},[]);
  const typeMap=Object.fromEntries(types.map(t=>[t.code,t.name_zh]));
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'tabs'},
      [['req','ÂÅáÊù°ËÆ∞ÂΩï'],['type','ÂÅáÊúüÁ±ªÂûã']].map(([k,l])=>React.createElement('div',{key:k,className:`tab ${tab===k?'active':''}`,onClick:()=>setTab(k)},l))),
    tab==='req'?React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['Áî≥ËØ∑Âè∑','ÂëòÂ∑•','ËÅåÁ∫ß','Á±ªÂûã','ÂºÄÂßã','ÁªìÊùü','Â§©Êï∞','ÂéüÂõ†','Áä∂ÊÄÅ'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,reqs.map(r=>React.createElement('tr',{key:r.id},
          React.createElement('td',null,r.id),React.createElement('td',null,r.employee_name),
          React.createElement('td',{style:{color:gradeColor(r.grade),fontWeight:700}},r.grade),
          React.createElement('td',null,typeMap[r.leave_type]||r.leave_type),
          React.createElement('td',null,r.start_date),React.createElement('td',null,r.end_date),
          React.createElement('td',{style:{fontWeight:700}},r.days),
          React.createElement('td',null,r.reason),
          React.createElement('td',null,React.createElement(SBadge,{s:r.status})))))))
    :React.createElement('div',{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(250px,1fr))',gap:12}},
      types.map(lt=>React.createElement('div',{key:lt.code,className:'card'},
        React.createElement('div',{style:{fontWeight:700,fontSize:15}},lt.name_zh),
        React.createElement('div',{style:{fontSize:12,color:'var(--text2)'}},`${lt.name_en} / ${lt.name_de}`),
        React.createElement('div',{style:{marginTop:6,fontSize:12}},
          React.createElement('span',{className:'badge-s',style:{background:lt.paid?'rgba(34,197,94,.15)':'rgba(239,68,68,.15)',
            color:lt.paid?'var(--green)':'var(--red)'}},lt.paid?'Â∏¶Ëñ™':'Êó†Ëñ™'),' ',
          `ÈªòËÆ§${lt.default_days}Â§©`,lt.requires_proof?' ¬∑ ÈúÄËØÅÊòé':''),
        React.createElement('div',{style:{fontSize:11,color:'var(--text3)',marginTop:4}},lt.description)))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Expense ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const ExpPage=({t})=>{
  const[exps,setExps]=useState([]);
  useEffect(()=>{API.get('/api/expenses').then(setExps)},[]);
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['Êä•ÈîÄÂè∑','ÂëòÂ∑•','ËÅåÁ∫ß','Á±ªÂûã','ÈáëÈ¢ù','Êó•Êúü','ÊèèËø∞','Áä∂ÊÄÅ'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,exps.map(e=>React.createElement('tr',{key:e.id},
          React.createElement('td',null,e.id),React.createElement('td',null,e.employee_name),
          React.createElement('td',{style:{color:gradeColor(e.grade),fontWeight:700}},e.grade),
          React.createElement('td',null,e.claim_type),
          React.createElement('td',{style:{fontWeight:700,color:'var(--green)'}},`‚Ç¨${e.amount}`),
          React.createElement('td',null,e.claim_date),React.createElement('td',null,e.description),
          React.createElement('td',null,React.createElement(SBadge,{s:e.status}))))))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Performance ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const PerfPage=({t})=>{
  const[reviews,setR]=useState([]);
  useEffect(()=>{API.get('/api/performance').then(setR)},[]);
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['ÁºñÂè∑','ÂëòÂ∑•','ËÅåÁ∫ß','Âë®Êúü','Á±ªÂûã','ÊÄªÂàÜ','ËØÑÁ∫ß','Áä∂ÊÄÅ'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,reviews.map(r=>
          React.createElement('tr',{key:r.id},
            React.createElement('td',null,r.id),React.createElement('td',null,r.employee_name),
            React.createElement('td',{style:{color:gradeColor(r.grade),fontWeight:700}},r.grade),
            React.createElement('td',null,r.review_period),React.createElement('td',null,r.review_type),
            React.createElement('td',{style:{fontWeight:700,fontSize:16,color:r.total_score>=90?'var(--green)':r.total_score>=80?'var(--pri)':'var(--yellow)'}},r.total_score),
            React.createElement('td',null,React.createElement('span',{className:`badge-s ${r.rating?.includes('A')?'bg-green':r.rating?.includes('B')?'bg-blue':'bg-yellow'}`},r.rating)),
            React.createElement('td',null,React.createElement(SBadge,{s:r.status}))))))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Quotation ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const QuotePage=({t})=>{
  const[tpls,setTpls]=useState([]);const[recs,setRecs]=useState([]);const[tab,setTab]=useState('rec');
  useEffect(()=>{API.get('/api/quotation-templates').then(setTpls);API.get('/api/quotations').then(setRecs);},[]);
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'tabs'},
      [['rec','Êä•‰ª∑ËÆ∞ÂΩï'],['tpl','Êä•‰ª∑Ê®°Êùø']].map(([k,l])=>React.createElement('div',{key:k,className:`tab ${tab===k?'active':''}`,onClick:()=>setTab(k)},l))),
    tab==='rec'?React.createElement('div',{className:'table-wrap'},
      React.createElement('table',null,
        React.createElement('thead',null,React.createElement('tr',null,
          ['Êä•‰ª∑Âè∑','ÂÆ¢Êà∑','Á±ªÂûã','‰ªìÂ∫ì','‰∫∫Êï∞','Âçï‰ª∑','ÊÄªÈ¢ù','ÂÆ°Êâπ','ÂÆ¢Êà∑ÂõûÂ§ç'].map(h=>React.createElement('th',{key:h},h)))),
        React.createElement('tbody',null,recs.map(r=>React.createElement('tr',{key:r.id},
          React.createElement('td',null,r.id),React.createElement('td',null,r.client_name),
          React.createElement('td',null,`${r.biz_type}¬∑${r.service_type}`),
          React.createElement('td',null,r.warehouse_code),React.createElement('td',null,r.headcount),
          React.createElement('td',{style:{color:'var(--green)',fontWeight:700}},`‚Ç¨${r.final_price}`),
          React.createElement('td',{style:{fontWeight:700}},`‚Ç¨${r.total_amount}`),
          React.createElement('td',null,React.createElement(SBadge,{s:r.approve_status})),
          React.createElement('td',null,React.createElement(SBadge,{s:r.client_response})))))))
    :React.createElement('div',{style:{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(300px,1fr))',gap:12}},
      tpls.map(tp=>React.createElement('div',{key:tp.id,className:'card'},
        React.createElement('div',{style:{display:'flex',justifyContent:'space-between'}},
          React.createElement('div',null,
            React.createElement('div',{style:{fontWeight:700,fontSize:15}},tp.name),
            React.createElement('div',{style:{fontSize:12,color:'var(--text2)'}},`${tp.biz_type} ¬∑ ${tp.service_type}`)),
          React.createElement('div',{style:{textAlign:'right'}},
            React.createElement('div',{style:{fontSize:20,fontWeight:700,color:'var(--green)'}},`‚Ç¨${tp.base_price}`),
            React.createElement('div',{style:{fontSize:11,color:'var(--text3)'}},tp.unit))),
        React.createElement('div',{style:{marginTop:6,fontSize:12,color:'var(--text3)'}},
          `Â§úÁè≠+‚Ç¨${tp.night_surcharge} Âë®Êú´+‚Ç¨${tp.weekend_surcharge} ËäÇÂÅá+‚Ç¨${tp.holiday_surcharge}`)))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Files ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const FilePage=({t})=>{
  const[files,setF]=useState([]);const[emps,setE]=useState([]);const[selEmp,setSel]=useState('');
  useEffect(()=>{API.get('/api/files').then(setF);API.get('/api/employees').then(setE);},[]);
  const empNames=Object.fromEntries(emps.map(e=>[e.id,e.name]));
  const grouped=files.reduce((a,f)=>{(a[f.employee_id]=a[f.employee_id]||[]).push(f);return a;},{});
  return React.createElement('div',{className:'fade'},
    React.createElement('div',{className:'search-bar'},
      React.createElement('select',{value:selEmp,onChange:e=>setSel(e.target.value),
        style:{padding:'7px 12px',background:'var(--bg)',border:'1px solid var(--border)',borderRadius:6,color:'var(--text)',fontSize:13}},
        React.createElement('option',{value:''},'ÂÖ®ÈÉ®ÂëòÂ∑•'),
        emps.map(e=>React.createElement('option',{key:e.id,value:e.id},`${e.id} ${e.name}`)))),
    Object.entries(grouped).filter(([eid])=>!selEmp||eid===selEmp).map(([eid,fs])=>
      React.createElement('div',{key:eid,className:'card'},
        React.createElement('div',{style:{fontWeight:700,marginBottom:8}},`üìÅ ${empNames[eid]||eid} ÁöÑÊ°£Ê°à`),
        React.createElement('div',{style:{display:'flex',flexWrap:'wrap',gap:8}},
          fs.map(f=>React.createElement('div',{key:f.id,style:{background:'var(--bg)',padding:'8px 12px',borderRadius:6,fontSize:12,border:'1px solid var(--border)'}},
            React.createElement('div',null,f.confidential?'üîí':'üìÑ',' ',f.file_name),
            React.createElement('div',{style:{color:'var(--text3)',marginTop:2}},`${f.category} ¬∑ ${f.stage} ¬∑ ${f.upload_date}`)))))));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Clock ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const ClockPage=({lang,t})=>{
  const[time,setTime]=useState(new Date());
  useEffect(()=>{const t=setInterval(()=>setTime(new Date()),1000);return()=>clearInterval(t)},[]);
  return React.createElement('div',{className:'fade',style:{display:'flex',flexDirection:'column',alignItems:'center',paddingTop:60}},
    React.createElement('div',{style:{fontSize:64,fontWeight:700,fontFamily:'monospace',color:'var(--pri)'}},
      time.toLocaleTimeString(LOCALE_MAP[lang]||'en-US')),
    React.createElement('div',{style:{fontSize:18,color:'var(--text2)',margin:'8px 0 30px'}},
      time.toLocaleDateString(LOCALE_MAP[lang]||'en-US',{weekday:'long',year:'numeric',month:'long',day:'numeric'})),
    React.createElement('button',{className:'btn btn-pri',style:{padding:'16px 48px',fontSize:18,borderRadius:12}},
      `üïê ${t.clock}`));
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Main App ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const MENU = [
  {group:'‰∏™‰∫∫',items:[
    {key:'mypage',icon:'üë§',label:'ÊàëÁöÑÈ°µÈù¢',roles:['worker','wh','mgr','admin']},
  ]},
  {group:'Ê†∏ÂøÉ',items:[
    {key:'dashboard',icon:'üìä',label:'‰ª™Ë°®Áõò'},
    {key:'employees',icon:'üë•',label:'Ëä±ÂêçÂÜå'},
    {key:'grades',icon:'üèÖ',label:'ËÅåÁ∫ß‰ΩìÁ≥ª'},
    {key:'performance',icon:'üìà',label:'Áª©ÊïàËÄÉÊ†∏'},
  ]},
  {group:'‰∏öÂä°',items:[
    {key:'quotation',icon:'üí∞',label:'Êä•‰ª∑ÁÆ°ÁêÜ'},
    {key:'timesheet',icon:'‚è±Ô∏è',label:'Â∑•Êó∂ËÆ∞ÂΩï'},
    {key:'container',icon:'üì¶',label:'Ë£ÖÂç∏Êüú'},
    {key:'schedule',icon:'üìÖ',label:'ÊéíÁè≠'},
    {key:'dispatch',icon:'üöõ',label:'Ê¥æÈÅ£ÈúÄÊ±Ç'},
  ]},
  {group:'‰∫∫‰∫ã',items:[
    {key:'files',icon:'üìÅ',label:'‰∫∫ÂëòÊ°£Ê°à'},
    {key:'leave',icon:'üèñÔ∏è',label:'ÂÅáÊúüÁÆ°ÁêÜ'},
    {key:'expense',icon:'üí≥',label:'Êä•ÈîÄÂÆ°Êâπ'},
    {key:'suppliers',icon:'üè¢',label:'‰æõÂ∫îÂïÜ'},
  ]},
  {group:'Ë¥¢Âä°&Á≥ªÁªü',items:[
    {key:'settlement',icon:'üí∂',label:'Ë¥¢Âä°ÁªìÁÆó'},
    {key:'whsalary',icon:'üè≠',label:'‰ªìÂ∫ìËñ™ËµÑ',roles:['admin','hr','mgr']},
    {key:'accounts',icon:'üîë',label:'Ë¥¶Âè∑ÁÆ°ÁêÜ',roles:['admin','hr','mgr']},
    {key:'clock',icon:'üïê',label:'ÊâìÂç°'},
    {key:'admin',icon:'‚öôÔ∏è',label:'ÊùÉÈôêÁÆ°ÁêÜ',roles:['admin']},
  ]}
];

const App=()=>{
  const[user,setUser]=useState(()=>{
    try{return JSON.parse(localStorage.getItem('hr_user')||'null')}catch{return null}
  });
  const[page,setPage]=useState('dashboard');
  const[lang,setLang]=useState('zh');
  const[sideOpen,setSide]=useState(false);
  const t=T[lang];

  useEffect(()=>{if('serviceWorker' in navigator)navigator.serviceWorker.register('/sw.js').catch(()=>{})},[]);

  if(!user) return React.createElement(LoginPage,{onLogin:setUser,lang,setLang});

  const pages={
    dashboard:DashPage, employees:EmpPage, grades:GradePage, performance:PerfPage,
    quotation:QuotePage, files:FilePage, leave:LeavePage, expense:ExpPage,
    timesheet:TSPage, settlement:SettPage, clock:ClockPage,
    mypage:MyPage, accounts:AccountPage, whsalary:WHSalaryPage,
  };
  const PageComp=pages[page];

  const canView=(item)=>{
    if(!item.roles)return true;
    return item.roles.includes(user.role);
  };

  return React.createElement('div',{className:'app'},
    sideOpen&&React.createElement('div',{className:'sidebar-mask show',onClick:()=>setSide(false)}),
    React.createElement('div',{className:`sidebar ${sideOpen?'open':''}`},
      React.createElement('div',{className:'logo'},'Ê∏äÂçö579',React.createElement('small',null,'HR System V6')),
      MENU.map(g=>{
        const visibleItems=g.items.filter(canView);
        if(!visibleItems.length)return null;
        return React.createElement(React.Fragment,{key:g.group},
          React.createElement('div',{className:'nav-group'},g.group),
          visibleItems.map(i=>React.createElement('div',{key:i.key,className:`nav-item ${page===i.key?'active':''}`,
            onClick:()=>{setPage(i.key);setSide(false)}},i.icon,' ',t[i.key]||i.label)));
      }),
      React.createElement('div',{style:{padding:12,borderTop:'1px solid var(--border)',marginTop:'auto'}},
        React.createElement('div',{style:{display:'flex',gap:4,marginBottom:8}},
          LANGS.map(l=>React.createElement('span',{key:l.c,onClick:()=>setLang(l.c),
            style:{cursor:'pointer',padding:'2px 6px',borderRadius:4,fontSize:11,
              background:lang===l.c?'var(--pri)':'transparent',color:lang===l.c?'#fff':'var(--text3)'}},l.n))),
        React.createElement('button',{className:'btn btn-ghost btn-sm',style:{width:'100%'},
          onClick:()=>{API.setToken('');localStorage.removeItem('hr_user');setUser(null)}},t.logout))),
    React.createElement('div',{className:'main'},
      React.createElement('div',{className:'header'},
        React.createElement('div',{className:'menu-btn',onClick:()=>setSide(!sideOpen)},'‚ò∞'),
        React.createElement('div',{className:'title'},t[page]||page),
        React.createElement('div',{className:'user-info'},
          React.createElement('span',{className:'badge'},user.role||'admin'),
          React.createElement('span',null,user.display_name||'Admin'))),
      React.createElement('div',{className:'content'},
        PageComp?React.createElement(PageComp,{t,user,lang}):React.createElement('div',{className:'empty'},'Ê®°ÂùóÂºÄÂèë‰∏≠...'))),
    React.createElement('div',{id:'toast',className:'toast',style:{display:'none'}}));
};

ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
const fallback=document.getElementById('login-fallback');
if(fallback) fallback.style.display='none';
</script>
</body>
</html>
